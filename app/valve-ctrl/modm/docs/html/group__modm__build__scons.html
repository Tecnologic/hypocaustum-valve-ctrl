<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="DoxyPress 1.7.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm API documentation: SCons Build Script Generator</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxypress.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by DoxyPress -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm API documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by DoxyPress 1.7.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__modm__build__scons.html',''); initResizable(); });
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
    <div class="title">SCons Build Script Generator<div class="ingroups"><a class="el" href="group__modm__build.html">Build System Generators</a></div></div>
  </div>
  <div class="clear-floats"></div>
</div><!--header-->
<div class="contents">
<p>lbuild module: <code>modm:build:scons</code></p>
<p><a href="http://scons.org">SCons</a> is a software construction build system written in Python. For a better embedded experience, we've extended it with modm-specific build tools.</p>
<p>This module generates two files:</p>
<ul>
<li>a <code>modm/SConscript</code> file: configures all required SCons tools with the right settings (also using information from the <a href="group__modm__build.html"><code>modm:build</code></a> module) to compile the modm library.</li>
<li>a top-level BSD-licensed <code>SConstruct</code> file: configures additional, optional tools and sets up all the relevant SCons functions for your target.</li>
</ul>
<p>The <code>SConscript</code> file is self contained and does not depend on anything outside of the <code>modm/</code> directory. This allows it to be combined with <code>SConscript</code> of other projects without clashing.</p>
<p>In fact, if you look at your generated <code>SConstruct</code> file, you'll notice that it doesn't contain a lot of logic or specific data, it is only meant for calling the right SCons tool with the right arguments.</p>
<p>We do not intend to serve every possible use-case with this module. <b>If you need something special, write your own SConstruct file, maybe starting by modifying ours.</b> It is intentionally BSD-licensed so that you do not have to publish your changes to it.</p>
<p>Remember to set <a href="group__modm__build__scons.html"><code>modm:build:scons:include_sconstruct</code></a> to <code>False</code>, so that your custom <code>SConstruct</code> does not get overwritten by <code>lbuild build</code>. See the instructions inside our generated default <code>SConstruct</code> file.</p>
<h2>SCons Methods</h2>
<p>This module generates these SCons methods depending on the target.</p>
<h4>scons</h4>
<p>Defaults to <b>scons build size</b>.</p>
<p>You can add these arguments to any of the SCons commands:</p>
<ul>
<li><code>verbose=1</code>: gives a more verbose output, so you can, for example, check what options the compiler is called with.</li>
<li><code>profile=release</code>: Compile project with the release profile options (default).</li>
<li><code>profile=debug</code>: Compile project with the debug profile options.</li>
</ul>
<p>For a description of the <code>release</code> and <code>debug</code> profiles, see the <a href="group__modm__build.html"><code>modm:build</code></a> module documentation.</p>
<dl class="section note"><dt>Note</dt><dd>Debug Profile When working with the debug profile, make sure to add <code>profile=debug</code> to all commands, especially <code>scons program profile=debug</code> and <code>scons debug profile=debug</code>!</dd></dl>
<p>Some SCons commands take a <code>firmware={GNU Build ID or path/to/firmware.elf}</code> argument that specifies which firmware to use for the command. It is useful in combination with the <code>scons artifact</code> command to preserve a specific firmware version for later.</p>
<h4>scons build</h4>
<div class="fragment"><div class="line">scons build profile={debug|release}</div>
</div><!-- end fragment -->
<p>Compiles your application into an executable.</p>
<p>Example for a STM32 target:</p>
<div class="fragment"><div class="line"> $ scons build</div>
<div class="line">Compiling C++·· {debug|release}/main.o</div>
<div class="line">Compiling C···· {debug|release}/modm/ext/gcc/cabi.o</div>
<div class="line">    ...</div>
<div class="line">Compiling C++·· {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/src/modm/utils/dummy.o</div>
<div class="line">Archiving······ {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/libmodm.a</div>
<div class="line">Indexing······· {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/libmodm.a</div>
<div class="line">Linking········ /build/{<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/blink.elf</div>
</div><!-- end fragment -->
<h4>scons -c</h4>
<div class="fragment"><div class="line">scons -c profile={debug|release}</div>
</div><!-- end fragment -->
<p>Cleans the build artifacts.</p>
<div class="fragment"><div class="line"> $ scons -c</div>
<div class="line">Removed {debug|release}/main.o</div>
<div class="line">Removed {debug|release}/modm/ext/tlsf/tlsf.o</div>
<div class="line">    ...</div>
<div class="line">Removed {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/src/modm/ui/display/virtual_graphic_display.o</div>
<div class="line">Removed {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/src/modm/utils/dummy.o</div>
<div class="line">Removed {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/libmodm.a</div>
<div class="line">Removed {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/blink.elf</div>
<div class="line">Removed {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/blink.lss</div>
</div><!-- end fragment -->
<h4>scons size</h4>
<div class="fragment"><div class="line">scons size profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Displays the static Flash and RAM consumption of your target.</p>
<p>Example for a STM32 target with 16MB external heap:</p>
<div class="fragment"><div class="line"> $ scons size</div>
<div class="line">Memory usage··· /build/{debug|release}/blink.elf</div>
<div class="line">Program:  12.8 KiB (0.6% used)</div>
<div class="line">(.data + .fastcode + .fastdata + .hardware_init + .reset + .rodata +</div>
<div class="line"> .table.copy.extern + .table.copy.intern + .table.section_heap +</div>
<div class="line"> .table.zero.intern + .text)</div>
<div class="line"> </div>
<div class="line">Data:      5.8 KiB (1.5% used) = 2936 B <span class="keyword">static</span> (0.7%) + 3040 B stack (0.8%)</div>
<div class="line">(.bss + .data + .fastdata + .stack)</div>
<div class="line"> </div>
<div class="line">Heap:     16.4 MiB</div>
<div class="line">(.heap0 + .heap1 + .heap2 + .heap3 + .heap5 + .heap_extern)</div>
</div><!-- end fragment -->
<h4>scons program</h4>
<div class="fragment"><div class="line">scons program profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Writes the executable onto your target via Avrdude or OpenOCD. This is a convenience wrapper around the programming options and methods defined in the <a href="group__modm__build.html"><code>modm:build</code></a> module. (* <em>only AVR and ARM Cortex-M targets</em>)</p>
<p>Example for a STM32 target:</p>
<div class="fragment"><div class="line"> $ scons program</div>
<div class="line">╭────────────── /build/{debug|release}/blink.elf</div>
<div class="line">╰───OpenOCD───&gt; stm32f469nih</div>
<div class="line">Open On-Chip Debugger 0.10.0</div>
<div class="line">    ...</div>
<div class="line">Info : <span class="keyword">using </span>stlink api v2</div>
<div class="line">Info : Target voltage: 3.259396</div>
<div class="line">Info : stm32f4x.cpu: hardware has 6 breakpoints, 4 watchpoints</div>
<div class="line">    ...</div>
<div class="line">   Programming Started **</div>
<div class="line"><span class="keyword">auto</span> erase enabled</div>
<div class="line">Info : device <span class="keywordtype">id</span> = 0x10006434</div>
<div class="line">Info : flash size = 2048kbytes</div>
<div class="line">Info : Dual Bank 2048 kiB STM32F42x/43x/469/479 found</div>
<div class="line">    ...</div>
<div class="line">wrote 16384 bytes from file {debug|release}/blink.elf in 0.589736s (27.131 KiB/s)</div>
<div class="line">   Programming Finished **</div>
<div class="line">   Verify Started **</div>
<div class="line">verified 13064 bytes in 0.296308s (43.056 KiB/s)</div>
<div class="line">   Verified OK **</div>
<div class="line">shutdown command invoked</div>
</div><!-- end fragment -->
<h4>scons program-fuses</h4>
<div class="fragment"><div class="line">scons program-fuses profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Writes all fuses onto your target connected to avrdude. See the <a href="group__modm__platform__core.html"><code>modm:platform:core</code></a> module for how to define the fuse values. (* <em>only AVR targets</em>)</p>
<h4>scons program-dfu</h4>
<div class="fragment"><div class="line">scons program-dfu profile={debug|release} [firmware={hash or file}] [<a class="code" href="group__modm__architecture__delay.html#gad8b7a30b3952ba10c8f3677ab53a7931">delay</a>={seconds}]</div>
</div><!-- end fragment -->
<p>Writes the executable onto your target via Device Firmware Update (DFU) over USB. A DFU bootloader is available on many STM32 microcontrollers and can be accessed by pressing the BOOT0-Button during startup.</p>
<p>Some DFU devices require additional delay to re-enumerate, which you can specify with the <code>delay</code> parameter (default is 5 seconds). (* <em>only ARM Cortex-M targets</em>)</p>
<div class="fragment"><div class="line">$ scons program-dfu</div>
<div class="line">Binary File···· /build/{debug|release}/blink.<a class="code" href="classmodm_1_1IOStream.html#a2ec24a2c020997b5704df1d9ac99264c">bin</a></div>
<div class="line">╭────────────── /build/{debug|release}/blink.<a class="code" href="classmodm_1_1IOStream.html#a2ec24a2c020997b5704df1d9ac99264c">bin</a></div>
<div class="line">╰─────DFU─────&gt; stm32f469nih</div>
<div class="line">dfu_stm32_programmer: program /build/{<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/blink.<a class="code" href="classmodm_1_1IOStream.html#a2ec24a2c020997b5704df1d9ac99264c">bin</a></div>
<div class="line">dfu-util 0.9</div>
<div class="line">Opening DFU capable USB device...</div>
<div class="line">ID 0483:df11</div>
<div class="line">Run-time device DFU version 011a</div>
<div class="line">Claiming USB DFU Interface...</div>
<div class="line">Determining device status: state = dfuIDLE, status = 0</div>
<div class="line">dfuIDLE, continuing</div>
<div class="line">DFU mode device DFU version 011a</div>
<div class="line">Device returned transfer size 2048</div>
<div class="line">DfuSe <span class="keyword">interface </span>name: &quot;Internal Flash  &quot;</div>
<div class="line">Memory segment at 0x08000000   4 x 16384 = 65536 (rew)</div>
<div class="line">Memory segment at 0x08010000   1 x 65536 = 65536 (rew)</div>
<div class="line">Memory segment at 0x08020000   1 x 131072 = 131072 (rew)</div>
<div class="line">Downloading to address = 0x08000000, size = 2060</div>
<div class="line">Download        [                         ]   0%            0 bytes   Poll timeout 100 ms</div>
<div class="line">   Poll timeout 0 ms</div>
<div class="line"> Download from image offset 00000000 to memory 08000000-080007ff, size 2048</div>
<div class="line">   Poll timeout 104 ms</div>
<div class="line">   Poll timeout 0 ms</div>
<div class="line"> Download from image offset 00000800 to memory 08000800-0800080b, size 12</div>
<div class="line">   Poll timeout 104 ms</div>
<div class="line">   Poll timeout 0 ms</div>
<div class="line">File downloaded successfully</div>
<div class="line">   Poll timeout 104 ms</div>
<div class="line">   Poll timeout 0 ms</div>
<div class="line">Transitioning to dfuMANIFEST state</div>
<div class="line">scons: done building targets.</div>
</div><!-- end fragment -->
<h4>scons program-bmp</h4>
<div class="fragment"><div class="line">scons program-bmp profile={debug|release} port={serial-port} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p><a href="https://github.com/blacksphere/blackmagic">Black Magic Probe</a> is convenient tool to convert cheap USB ST-LINK V2 clones to a fully functional GDB compatible debug adaptor for ARM Cortex microcontrollers. GDB can directly communicate with the debug adaptor making debugging easy and accessible. (* <em>only ARM Cortex-M targets</em>)</p>
<p>Black Magic Probe creates two serial devices, the first being the GDB interface and the second a plain serial adaptor for debugging purposes.</p>
<div class="fragment"><div class="line">$ ls -l /dev/tty.usb*</div>
<div class="line">crw-rw-rw-  1 root  wheel   21, 104 Feb 19 09:46 /dev/tty.usbmodemDEADBEEF</div>
<div class="line">crw-rw-rw-  1 root  wheel   21, 106 Feb 19 09:46 /dev/tty.usbmodemDEADBEF1</div>
</div><!-- end fragment -->
<p>You can let the tool guess the port or explicitly specify it:</p>
<div class="fragment"><div class="line">$ scons program-bmp port=/dev/tty.usbmodemDEADBEEF</div>
<div class="line">╭─Black─Magic── /build/{debug|release}/blink.elf</div>
<div class="line">╰────Probe────&gt; stm32f103rbt6</div>
<div class="line">Remote debugging <span class="keyword">using </span>/dev/tty.usbmodemDEADBEEF</div>
<div class="line">Target voltage: unknown</div>
<div class="line">Available Targets:</div>
<div class="line">No. Att Driver</div>
<div class="line"> 1      STM32F1 medium density</div>
<div class="line">Attaching to Remote target</div>
<div class="line">warning: No executable has been specified and target does not support</div>
<div class="line">determining executable automatically.  Try <span class="keyword">using </span>the <span class="stringliteral">&quot;file&quot;</span> command.</div>
<div class="line">0x0800038e in ?? ()</div>
<div class="line">Loading section .vector_rom, size 0xec lma 0x8000000</div>
<div class="line">[...]</div>
<div class="line">Loading section .table.section_heap, size 0xc lma 0x80013f8</div>
<div class="line">Start address 0x8000e6c, load size 5120</div>
<div class="line">Transfer rate: 10 KB/sec, 365 bytes/write.</div>
<div class="line">Detaching from program: , Remote target</div>
<div class="line">[Inferior 1 (Remote target) detached]</div>
<div class="line">scons: done building targets.</div>
</div><!-- end fragment -->
<h4>scons program-remote</h4>
<div class="fragment"><div class="line">scons program-remote profile={debug|release} [host={ip or hostname:port}] [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Writes the executable onto your target connected to a remote backend process running on your own computer (<code>host=":3333"</code>) or somewhere else. You can also connect to JLink (<code>host=":2331"</code>) or Black Magic Probe (<code>host="/dev/tty.usbserial"</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons program-jlink</h4>
<div class="fragment"><div class="line">scons program-jlink profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Writes the executable onto your target via JLink. This is a convenience wrapper around the programming options and methods defined in the <a href="group__modm__build.html"><code>modm:build</code></a> module. (* <em>only ARM Cortex-M targets</em>)</p>
<p>Example for a STM32 target:</p>
<div class="fragment"><div class="line"> $ scons program-jlink</div>
<div class="line">╭────────────── /build/{debug|release}/blink.elf</div>
<div class="line">╰────JLink────&gt; stm32l476rgt6</div>
<div class="line">SEGGER J-Link GDB Server V7.84f Command Line Version</div>
<div class="line"> </div>
<div class="line">JLinkARM.dll V7.84f (DLL compiled Feb  7 2023 16:45:51)</div>
<div class="line"> </div>
<div class="line">-----GDB Server start settings-----</div>
<div class="line">GDBInit file:                  none</div>
<div class="line">GDB Server Listening port:     2331</div>
<div class="line">SWO raw output listening port: 2332</div>
<div class="line">Terminal I/O port:             2333</div>
<div class="line">Accept remote connection:      yes</div>
<div class="line">Generate logfile:              off</div>
<div class="line">Verify download:               off</div>
<div class="line">Init regs on start:            off</div>
<div class="line">Silent mode:                   on</div>
<div class="line">Single run mode:               off</div>
<div class="line">Target connection timeout:     0 ms</div>
<div class="line">------J-Link related settings------</div>
<div class="line">J-Link Host interface:         USB</div>
<div class="line">J-Link script:                 none</div>
<div class="line">J-Link settings file:          none</div>
<div class="line">------Target related settings------</div>
<div class="line">Target device:                 stm32l476rg</div>
<div class="line">Target device parameters:      none</div>
<div class="line">Target interface:              SWD</div>
<div class="line">Target <span class="keyword">interface </span>speed:        4000kHz</div>
<div class="line">Target endian:                 little</div>
<div class="line"> </div>
<div class="line">warning: Source file is more recent than executable.</div>
<div class="line">Resetting target</div>
<div class="line">scons: done building targets.</div>
</div><!-- end fragment -->
<h4>scons openocd</h4>
<div class="fragment"><div class="line">scons openocd</div>
</div><!-- end fragment -->
<p>Starts an OpenOCD process to attach a remote debugger to (e.g. with <code>scons program-remote</code> or <code>scons debug-remote</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons jlink</h4>
<div class="fragment"><div class="line">scons jlink</div>
</div><!-- end fragment -->
<p>Starts a JLinkGDBServer process to attach a remote debugger to (e.g. with <code>scons program-remote</code> or <code>scons debug-remote</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons run</h4>
<p>Compiles and executes your program on your computer. (* <em>only Hosted targets</em>)</p>
<h4>scons debug</h4>
<div class="fragment"><div class="line">scons debug profile={debug|release} ui={tui|gdbgui} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Launches OpenOCD in the background, then launches GDB in foreground with the correct executable with text-based or <a href="https://www.gdbgui.com">web-based GDBGUI</a> UI. When GDB exits, it stops the OpenOCD process. (* <em>only ARM Cortex-M targets</em>)</p>
<p>This is just a convenience wrapper for the debug functionality defined in the <a href="group__modm__build.html"><code>modm:build</code></a> module. To use GDBGUI you must have it installed via <code>pip install gdbgui</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Choose the correct profile When debugging, make sure to select the correct compilation profile. The firmware and the executable given to GDB have to be the same or you'll see GDB translate the program counter to the wrong code locations. When you suspect a bug in your firmware, consider that it was most likely compiled with the release profile, since that's the default. First try to <code>scons debug profile=release</code>, and if that doesn't help, compile and <code>scons program profile=debug</code> and try <code>scons debug profile=debug</code> again.</dd></dl>
<h4>scons debug-remote</h4>
<div class="fragment"><div class="line">scons debug-remote profile={debug|release} ui={tui|gdbgui} [host={ip or hostname:port}] [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Debugs the executable via a remote OpenOCD process running on your own computer (<code>host=":3333"</code>) or somewhere else. You can also connect to JLink (<code>host=":2331"</code>) or Black Magic Probe (<code>host="/dev/tty.usbserial"</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons debug-bmp</h4>
<div class="fragment"><div class="line">scons debug-bmp profile={debug|release} ui={tui|gdbgui} port={serial-port} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Launches GDB to debug via Black Magic Probe. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons debug-jlink</h4>
<div class="fragment"><div class="line">scons debug-jlink profile={debug|release} ui={tui|gdbgui} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Launches GDB to debug via JLink. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons debug-coredump</h4>
<div class="fragment"><div class="line">scons debug-coredump profile={debug|release} ui={tui|gdbgui} \</div>
<div class="line">                     coredump={path/to/coredump.txt} \</div>
<div class="line">                     [firmware={GNU Build ID or path/to/firmware.elf}]</div>
</div><!-- end fragment -->
<p>Launches GDB for post-mortem debugging with the firmware identified by the (optional) <code>firmware={hash or filepath}</code> argument using the data from the <code>coredump={filepath}</code> argument. Note that CrashDebug must be in your path, see the <code>modm:crashcatcher</code> module for details.</p>
<p>Use the <code>scons coredump</code> method to generate a coredump with a debugger attached, otherwise see the <code>modm:platform:fault</code> module for details how to generate and receive the coredump data from the device itself. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons coredump</h4>
<div class="fragment"><div class="line">scons coredump</div>
</div><!-- end fragment -->
<p>Launches GDB via OpenOCD and creates a <code>coredump.txt</code> file containing all volatile memories and prints the GNU build ID of the firmware under debug. Note that this command does not require an ELF file, so it can be used to coredump any firmware whose ELF file is currently unavailable. You can use the GNU build ID to find the corresponding ELF file in your artifact store (see <code>scons artifact</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons coredump-bmp</h4>
<div class="fragment"><div class="line">scons coredump-bmp port={serial-port}</div>
</div><!-- end fragment -->
<p>Creates a coredump via Black Magic Probe. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons coredump-jlink</h4>
<div class="fragment"><div class="line">scons coredump-jlink</div>
</div><!-- end fragment -->
<p>Creates a coredump via JLink. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons reset</h4>
<div class="fragment"><div class="line">scons reset</div>
</div><!-- end fragment -->
<p>Resets the executable via OpenOCD. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons reset-bmp</h4>
<div class="fragment"><div class="line">scons reset-bmp port={serial-port}</div>
</div><!-- end fragment -->
<p>Resets the executable via Black Magic Probe. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons reset-jlink</h4>
<div class="fragment"><div class="line">scons reset-jlink</div>
</div><!-- end fragment -->
<p>Resets the executable via JLink. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons reset-remote</h4>
<div class="fragment"><div class="line">scons reset-remote [host={ip or hostname:port}]</div>
</div><!-- end fragment -->
<p>Resets the executable via a remote OpenOCD process running on your own computer (<code>host=":3333"</code>) or somewhere else. You can also connect to JLink (<code>host=":2331"</code>) or Black Magic Probe (<code>host="/dev/tty.usbserial"</code>). (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons log-itm</h4>
<div class="fragment"><div class="line">scons log-itm fcpu={HCLK in Hz}</div>
</div><!-- end fragment -->
<p>Configures OpenOCD in tracing mode to output ITM channel 0 on SWO pin and displays the serial output stream. (* <em>only ARM Cortex-M targets</em>)</p>
<div class="fragment"><div class="line"> $ scons log-itm fcpu=64000000</div>
<div class="line">╭───OpenOCD───&gt; Single Wire Viewer</div>
<div class="line">╰─────SWO────── stm32f103rbt6</div>
<div class="line">Open On-Chip Debugger 0.10.0</div>
<div class="line">Licensed under GNU GPL v2</div>
<div class="line">Info : The selected transport took over low-level target control.</div>
<div class="line">loop: 57</div>
<div class="line">loop: 58</div>
<div class="line">loop: 59</div>
<div class="line">loop: 60</div>
<div class="line">loop: 61</div>
</div><!-- end fragment -->
<p>See the <code>modm:platform:itm</code> module for details how to use the ITM as a logging output.</p>
<h4>scons log-itm-jlink</h4>
<div class="fragment"><div class="line">scons log-itm-jlink [channel={<span class="keywordtype">int</span>}]</div>
</div><!-- end fragment -->
<p>Outputs the ITM channel via JLinkSWOViewer. Note that JLink auto-detects the CPU frequency. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons log-rtt</h4>
<div class="fragment"><div class="line">scons log-rtt [channel={<span class="keywordtype">int</span>}]</div>
</div><!-- end fragment -->
<p>Configures OpenOCD in RTT mode to output the chosen channel (default 0) via a simple telnet client. Disconnect with Ctrl+D. (* <em>only ARM Cortex-M targets</em>)</p>
<div class="fragment"><div class="line"> $ scons log-rtt</div>
<div class="line">╭───OpenOCD───&gt; Real Time Transfer</div>
<div class="line">╰─────RTT────── stm32f103rbt6</div>
<div class="line">Info : rtt: Searching <span class="keywordflow">for</span> control block <span class="stringliteral">&#39;SEGGER RTT&#39;</span></div>
<div class="line">Info : rtt: Control block found at 0x20000008</div>
<div class="line">loop: 57</div>
<div class="line">loop: 58</div>
<div class="line">loop: 59</div>
<div class="line">loop: 60</div>
<div class="line">loop: 61</div>
</div><!-- end fragment -->
<p>See the <a href="group__modm__platform__rtt.html"><code>modm:platform:rtt</code></a> module for details how to use RTT for data transfer.</p>
<h4>scons log-rtt-jlink</h4>
<div class="fragment"><div class="line">scons log-rtt-jlink [channel={<span class="keywordtype">int</span>}]</div>
</div><!-- end fragment -->
<p>Configures JLink in RTT mode to output the chosen channel (default 0) via a simple telnet client. Disconnect with Ctrl+D. (* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons library</h4>
<div class="fragment"><div class="line">scons library profile={debug|release}</div>
</div><!-- end fragment -->
<p>Generates only the static library <code>libmodm.a</code> without linking it to the application.</p>
<div class="fragment"><div class="line"> $ scons library</div>
<div class="line">Compiling C++·· {debug|release}/modm/ext/gcc/assert.o</div>
<div class="line">    ...</div>
<div class="line">Compiling C++·· {debug|release}/modm/src/modm/utils/dummy.o</div>
<div class="line">Archiving······ {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/libmodm.a</div>
<div class="line">Indexing······· {<a class="code" href="namespacemodm_1_1log.html#ae9143446ab426d7e3ebf45751c11e66a">debug</a>|release}/modm/libmodm.a</div>
</div><!-- end fragment -->
<h4>scons symbols</h4>
<div class="fragment"><div class="line">scons symbols profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Dumps the symbol table for your executable.</p>
<div class="fragment"><div class="line"> $ scons symbols [firmware={hash or file}]</div>
<div class="line">Show symbols <span class="keywordflow">for</span> <span class="stringliteral">&#39;{debug|release}/blink.elf&#39;</span>:</div>
<div class="line">536871656 00000001 b (anonymous <span class="keyword">namespace</span>)::nextOperation</div>
<div class="line">536871657 00000001 b (anonymous namespace)::checkNextOperation</div>
<div class="line">536871658 00000001 b (anonymous namespace)::error</div>
<div class="line">536871444 00000001 b read_touch()::initialized</div>
<div class="line">    ...</div>
<div class="line">134228236 00000668 T I2C1_EV_IRQHandler</div>
<div class="line">134224924 00001136 T otm8009a_init(unsigned char)</div>
<div class="line">134221192 00001378 t _GLOBAL__sub_I_p</div>
<div class="line">536871782 00002054 b (anonymous namespace)::txBuffer</div>
</div><!-- end fragment -->
<h4>scons listing</h4>
<div class="fragment"><div class="line">scons listing profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Decompiles your executable into an annotated assembly listing. This is very useful for checking and learning how the compiler translates C++ into assembly instructions:</p>
<div class="fragment"><div class="line"> $ scons listing</div>
<div class="line">Listing········ {debug|release}/blink.lss</div>
<div class="line"> $ less {debug|release}/blink.lss</div>
<div class="line">    ...</div>
<div class="line">Disassembly of section .text:</div>
<div class="line">    ...</div>
<div class="line">08000d74 &lt;main&gt;:</div>
<div class="line">main():</div>
<div class="line">./main.cpp:315</div>
<div class="line"> </div>
<div class="line">int</div>
<div class="line">main()</div>
<div class="line">{</div>
<div class="line"> 8000d74:   b508        push    {r3, lr}</div>
<div class="line">    Board::initialize();</div>
<div class="line"> 8000d76:   f7ff fcc9   bl  800070c &lt;_ZN5Board10initializeEv&gt;</div>
<div class="line">    Board::initializeDisplay();</div>
<div class="line"> 8000d7a:   f000 fd91   bl  80018a0 &lt;_ZN5Board17initializeDisplayEv&gt;</div>
<div class="line">    Board::initializeTouchscreen();</div>
<div class="line"> 8000d7e:   f7ff fc55   bl  800062c &lt;_ZN5Board21initializeTouchscreenEv&gt;</div>
<div class="line">    blink();</div>
<div class="line"> 8000d82:   f7ff feff   bl  8000b84 &lt;_Z12blinkv&gt;</div>
<div class="line">    ...</div>
</div><!-- end fragment -->
<h4>scons bin</h4>
<div class="fragment"><div class="line">scons <a class="code" href="group__modm__io.html#gaa3870b0cd1e55a28adf436bdd45d7eaf">bin</a> profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Creates a binary file of your executable.</p>
<div class="fragment"><div class="line"> $ scons <a class="code" href="group__modm__io.html#gaa3870b0cd1e55a28adf436bdd45d7eaf">bin</a></div>
<div class="line">Binary File···· {debug|release}/blink.<a class="code" href="classmodm_1_1IOStream.html#a2ec24a2c020997b5704df1d9ac99264c">bin</a></div>
</div><!-- end fragment -->
<h4>scons hex</h4>
<div class="fragment"><div class="line">scons <a class="code" href="group__modm__io.html#gaf61485290089e35ac0a897af1c37d4f0">hex</a> profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Creates a Intel-hex file of your executable.</p>
<div class="fragment"><div class="line"> $ scons <a class="code" href="group__modm__io.html#gaf61485290089e35ac0a897af1c37d4f0">hex</a></div>
<div class="line">Hex File······· {debug|release}/blink.<a class="code" href="classmodm_1_1IOStream.html#a067f916e909f11b5c149d72a27d60b16">hex</a></div>
</div><!-- end fragment -->
<h4>scons uf2</h4>
<div class="fragment"><div class="line">scons uf2 profile={debug|release} [firmware={hash or file}]</div>
</div><!-- end fragment -->
<p>Creates a UF2 compatible file of your executable. UF2 is a <a href="https://github.com/microsoft/uf2">bootloader by Microsoft</a>.</p>
<div class="fragment"><div class="line"> $ scons uf2</div>
<div class="line">UF2 File······· {debug|release}/blink.uf2</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h4>scons artifact</h4>
<div class="fragment"><div class="line">scons artifact profile={debug|release}</div>
</div><!-- end fragment -->
<p>Caches the ELF and binary file of the newest compiled executable identified by the hash of the binary file in <code>artifacts/{hash}.elf</code>. You can change this path with the <a href="group__modm__build__scons.html"><code>modm:build:scons:path.artifact</code></a> option.</p>
<div class="fragment"><div class="line"> $ scons artifact</div>
<div class="line">╭───Artifact─── /build/release/blink.elf</div>
<div class="line">╰────Cache────&gt; artifacts/0214523ab713bc7bdfb37d902e65dae8305f4754.elf</div>
</div><!-- end fragment -->
<h4>scons qtcreator</h4>
<p>Generates several files so that the project can be imported into Qt Creator via the <code>.creator</code> file importer. Note, that no compiliation or debugging features are supported, this is only meant for using the IDE as an editor.</p>
<dl class="section warning"><dt>Warning</dt><dd>Consider this an unstable feature</dd></dl>
<h2>Protobuf Generator Tool</h2>
<p>The <code>modm:nanopb</code> module contains a Python generator to translate the messages defined in <code>*.proto</code> files by the <code>modm:nanopb:source</code> option into <code>*.pb.cpp</code> and <code>*.pb.hpp</code> files. This module contains a SCons wrapper tool that automatically updates the generated files when it becomes necessary:</p>
<div class="fragment"><div class="line">cpp_sources += env.NanopbProtofile(</div>
<div class="line">    sources=options[<span class="stringliteral">&quot;:nanopb:sources&quot;</span>],</div>
<div class="line">    path=options[<span class="stringliteral">&quot;:nanopb:path&quot;</span>],</div>
<div class="line">)</div>
</div><!-- end fragment -->
<p>The generated files are available as a top-level <code>#include &lt;protofile.pb.hpp&gt;</code>.</p>
<h2>XPCC Generator Tool</h2>
<p>The <code>modm:communication:xpcc:generator</code> module contains the Python tools to translate the XPCC XML declarations into various language implementations. This module contains a SCons wrapper tool, that understands the XML dependencies and automatically updates the generated files when it becomes necessary.</p>
<p>The wrapper tool is automatically used when the generator module is detected, and its options are evaluated for the wrapper as follows:</p>
<div class="fragment"><div class="line">cpp_sources += env.XpccCommunication(</div>
<div class="line">    xmlfile=options[<span class="stringliteral">&quot;::xpcc:generator:source&quot;</span>],</div>
<div class="line">    container=options[<span class="stringliteral">&quot;::xpcc:generator:container&quot;</span>],</div>
<div class="line">    path=options[<span class="stringliteral">&quot;::xpcc:generator:path&quot;</span>],</div>
<div class="line">    namespace=options[<span class="stringliteral">&quot;::xpcc:generator:namespace&quot;</span>]</div>
<div class="line">)</div>
</div><!-- end fragment -->
<p>The generated files are available as a top-level <code>#include &lt;identifiers.hpp&gt;</code>.</p>
<h2>Information Tool</h2>
<p>Our <code>info</code> SCons tool generates a set of header files containing information about the repository state.</p>
<p>A call to <code>env.InfoGit(with_status={True, False})</code> will generate a <code>&lt;info_git.h&gt;</code> header file and add these two defines to the command line CPP options:</p>
<ul>
<li><code>MODM_GIT_INFO</code></li>
<li><code>MODM_GIT_STATUS</code>: defined only if called with <code>with_state=True</code>.</li>
</ul>
<p>You can enable this by setting the <a href="group__modm__build.html"><code>modm:build:info.git</code></a> option.</p>
<dl class="section note"><dt>Note</dt><dd>Increased build time Since the git repository status can change at any time, it needs to be checked on every build. This adds less than a second to every build.</dd></dl>
<p>A call to <code>env.InfoBuild()</code> will generate a <code>&lt;info_build.h&gt;</code> header file and add this define to the command line CPP options:</p>
<ul>
<li><code>MODM_BUILD_INFO</code></li>
</ul>
<p>You can enable this by setting the <a href="group__modm__build.html"><code>modm:build:info.build</code></a> option.</p>
<dl class="section warning"><dt>Warning</dt><dd>Respect developers privacy This information is placed into the firmware in <b>cleartext</b>, so it will be trivial to extract from a memory dump. Consider this information public as soon as it is uploaded to your target. Make sure you only use the information you absolutely need!</dd></dl>
<h2>Bitmap Tool</h2>
<p>If the <a href="group__modm__build.html"><code>modm:build:image.source</code></a> is defined as a path, it'll be searched for <code>.pbm</code> files to convert into C++ data files using the <code>bitmap</code> tool:</p>
<div class="fragment"><div class="line">source, header = env.Bitmap(bpm_file)</div>
</div><!-- end fragment -->
<p>See the <code>GraphicsDisplay::drawImage()</code> method in the <code>modm:ui:display</code> module for how to use these generated files. The directory is added to the include search paths, so the generated files can be accessed as <code>#include &lt;image.hpp&gt;</code>.</p>
<h2>Module Options</h2>
<h3>modm:build:scons:include_sconstruct: Generate a SConstruct file</h3>
<dl class="section warning"><dt>Warning</dt><dd>This overwrites any top-level <code>SConstruct</code> file!</dd></dl>
<p>Generated with: <code>yes in [yes, no]</code> </p><h3>modm:build:scons:cache_dir: Path to SConstruct CacheDir</h3>
<p>If value is <code>$cache</code>, the cache is placed into the top-level <code>build/</code> folder. You can disable CacheDir by setting an empty string.</p>
<p>Generated with: <code>[] in [Path]</code> </p><h3>modm:build:scons:path.artifact: Path to Artifact Store</h3>
<p>The artifact folder contains ELF files named by their GNU build id hash. This allows identification of firmware on the device via serial output and is useful for archiving or post-mortem debugging.</p>
<p>Generated with: <code>artifacts in [Path]</code> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for DoxyPress 1.3.7-->
<!-- Generated by DoxyPress 1.7.0 -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.copperspice.com/documentation-doxypress.html">
    <img class="footer" src="doxypress.png" alt="DoxyPress"/></a> 1.7.0 </li>
  </ul>
</div>
<script>
if (window.location.href.includes("modm.io")) {
 var device = /\/api\/([a-zA-Z0-9_-]+)\//.exec(window.location.href)[1].toUpperCase();
 document.title = document.title.replace("modm API documentation", "modm API documentation for " + device);
 document.getElementById('projectname').innerHTML = document.getElementById('projectname').innerHTML.replace("modm API documentation", "modm API documentation for " + device);
}
document.getElementById('MSearchResults').onload = function()
{
  var iframe = document.getElementById('MSearchResults').contentWindow.document;
  var head = iframe.getElementsByTagName("head")[0];
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom.css");
  head.appendChild(link);
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom_dark_theme.css");
  head.appendChild(link);
}
</script>
</body>
</html>
