<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="DoxyPress 1.7.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm API documentation: Fiber Context Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxypress.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by DoxyPress -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm API documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by DoxyPress 1.7.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__modm__processing__fiber__context.html',''); initResizable(); });
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
    <div class="title">Fiber Context Functions<div class="ingroups"><a class="el" href="group__modm__processing.html">Processing</a> &raquo; <a class="el" href="group__modm__processing__fiber.html">Fibers</a></div></div>
  </div>
  <div class="clear-floats"></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmodm__context__t.html">modm_context_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">The fiber context stores information about the stack  <a href="structmodm__context__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga44ded0a88a5c17a4ca67d5d371134f05"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#ga44ded0a88a5c17a4ca67d5d371134f05">modm_context_init</a> (<a class="el" href="structmodm__context__t.html">modm_context_t</a> *ctx, uintptr_t *bottom, uintptr_t *top, uintptr_t fn, uintptr_t arg)</td></tr>
<tr class="separator:ga44ded0a88a5c17a4ca67d5d371134f05"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga199d5ef64c5137f21a69dd0b7be0bebf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#ga199d5ef64c5137f21a69dd0b7be0bebf">modm_context_reset</a> (<a class="el" href="structmodm__context__t.html">modm_context_t</a> *ctx)</td></tr>
<tr class="separator:ga199d5ef64c5137f21a69dd0b7be0bebf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae7b6dc80d14ff45fe0dc8afc2c261105"><td class="memItemLeft" align="right" valign="top">uintptr_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#gae7b6dc80d14ff45fe0dc8afc2c261105">modm_context_start</a> (<a class="el" href="structmodm__context__t.html">modm_context_t</a> *to)</td></tr>
<tr class="separator:gae7b6dc80d14ff45fe0dc8afc2c261105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac83be3baa50d8c1282f86a3e77c6ed2a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#gac83be3baa50d8c1282f86a3e77c6ed2a">modm_context_jump</a> (<a class="el" href="structmodm__context__t.html">modm_context_t</a> *from, <a class="el" href="structmodm__context__t.html">modm_context_t</a> *to)</td></tr>
<tr class="separator:gac83be3baa50d8c1282f86a3e77c6ed2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab259539d909f236fe1a5dc1a7f96b774"><td class="memItemLeft" align="right" valign="top">void modm_noreturn&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#gab259539d909f236fe1a5dc1a7f96b774">modm_context_end</a> (uintptr_t retval)</td></tr>
<tr class="separator:gab259539d909f236fe1a5dc1a7f96b774"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga26fa9eed1d7fa5540e2a7b5ec7197646"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#ga26fa9eed1d7fa5540e2a7b5ec7197646">modm_context_stack_watermark</a> (<a class="el" href="structmodm__context__t.html">modm_context_t</a> *ctx)</td></tr>
<tr class="separator:ga26fa9eed1d7fa5540e2a7b5ec7197646"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga40aabedc1612b75d53d4defef95de058"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__processing__fiber__context.html#ga40aabedc1612b75d53d4defef95de058">modm_context_stack_usage</a> (const <a class="el" href="structmodm__context__t.html">modm_context_t</a> *ctx)</td></tr>
<tr class="separator:ga40aabedc1612b75d53d4defef95de058"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>These functions implement the underlying architecture specific operations to initialize, start, yield, and end fibers. These can be used to implement an alternative scheduling strategy or use fibers outside of modm. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab259539d909f236fe1a5dc1a7f96b774"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm_noreturn modm_context_end </td>
          <td>(</td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>retval</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Switches control from the fiber context back to the main context. Control flow then continues in the main context by returning from the <code><a class="el" href="group__modm__processing__fiber__context.html#gae7b6dc80d14ff45fe0dc8afc2c261105">modm_context_start()</a></code> function. </p>

</div>
</div>
<a class="anchor" id="ga44ded0a88a5c17a4ca67d5d371134f05"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm_context_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t *&#160;</td>
          <td class="paramname"><em>bottom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t *&#160;</td>
          <td class="paramname"><em>top</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uintptr_t&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Initializes the context with the function pointer and argument stored at the top. The <code>ctx-&gt;sp</code> is set to two <code>uintptr_t</code> below the top. Must be called only once to initialize the stack.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fn</td><td>function pointer to a <code>void(*)(uintptr_t)</code> function. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gac83be3baa50d8c1282f86a3e77c6ed2a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm_context_jump </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Pushes the context onto the <code>from-&gt;sp</code> and pops the context from the <code>to-&gt;sp</code> to jump from one fiber to the next. </p>

</div>
</div>
<a class="anchor" id="ga199d5ef64c5137f21a69dd0b7be0bebf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm_context_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Resets the context stack pointer to the correct offset in preparation for jumping into the fiber. Must be called after initialization, but every time the function is started from the beginning. </p>

</div>
</div>
<a class="anchor" id="ga40aabedc1612b75d53d4defef95de058"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t modm_context_stack_usage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Returns the stack usage by searching from the bottom of the stack for the watermark level. You may call this function at any point after calling <code><a class="el" href="group__modm__processing__fiber__context.html#ga26fa9eed1d7fa5540e2a7b5ec7197646">modm_context_stack_watermark()</a></code>. </p>

</div>
</div>
<a class="anchor" id="ga26fa9eed1d7fa5540e2a7b5ec7197646"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void modm_context_stack_watermark </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Zeros the register file and watermarks the rest of the stack. You may call this function before or after <code><a class="el" href="group__modm__processing__fiber__context.html#ga199d5ef64c5137f21a69dd0b7be0bebf">modm_context_reset()</a></code>, however, <em>NOT</em> while the fiber is running! </p>

</div>
</div>
<a class="anchor" id="gae7b6dc80d14ff45fe0dc8afc2c261105"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uintptr_t modm_context_start </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmodm__context__t.html">modm_context_t</a> *&#160;</td>
          <td class="paramname"><em>to</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Switches control from the main context to the fiber context. This initializes the hardware and then jumps from the caller context into the <code>to</code> fiber. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for DoxyPress 1.3.7-->
<!-- Generated by DoxyPress 1.7.0 -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.copperspice.com/documentation-doxypress.html">
    <img class="footer" src="doxypress.png" alt="DoxyPress"/></a> 1.7.0 </li>
  </ul>
</div>
<script>
if (window.location.href.includes("modm.io")) {
 var device = /\/api\/([a-zA-Z0-9_-]+)\//.exec(window.location.href)[1].toUpperCase();
 document.title = document.title.replace("modm API documentation", "modm API documentation for " + device);
 document.getElementById('projectname').innerHTML = document.getElementById('projectname').innerHTML.replace("modm API documentation", "modm API documentation for " + device);
}
document.getElementById('MSearchResults').onload = function()
{
  var iframe = document.getElementById('MSearchResults').contentWindow.document;
  var head = iframe.getElementsByTagName("head")[0];
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom.css");
  head.appendChild(link);
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom_dark_theme.css");
  head.appendChild(link);
}
</script>
</body>
</html>
