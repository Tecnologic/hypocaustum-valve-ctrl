<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="DoxyPress 1.7.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>modm API documentation: Build System Generators</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxypress.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
<link href="custom_dark_theme.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by DoxyPress -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">modm API documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by DoxyPress 1.7.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__modm__build.html',''); initResizable(); });
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a>  </div>
  <div class="headertitle">
    <div class="title">Build System Generators</div>
  </div>
  <div class="clear-floats"></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__modm__build__scons"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__modm__build__scons.html">SCons Build Script Generator</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>lbuild module: <code>modm:build</code></p>
<p>This parent module defines a common set of functionality that is independent of the specific build system generator implementation. This includes straight-forward options like project name and build path but also more complicated configuration for programming your target via AvrDude or OpenOCD and debugging via GDB.</p>
<p>Note that this module does not compile your project, you will need to choose the <a href="group__modm__build__scons.html"><code>modm:build:scons</code></a> or <code>modm:build:cmake</code> submodule for that, or provide your own build system.**</p>
<h2>Compiler Options</h2>
<p>We maintain a common set of compiler options for all build system generator, so that they all have feature parity. We currently only support compiling modm with GCC for AVR, ARM Cortex-M and x86/posix with the options mentioned in the <a href="https://gcc.gnu.org/onlinedocs/gcc/Option-Summary.html">offical GCC options documentation</a>.</p>
<p>You can find all compiler options inside the generated build script for your project, the options presented here are only the most important ones.</p>
<h4>Shared for C and C++</h4>
<ul>
<li><code>-W{all, extra}</code>: a basic set of warnings.</li>
<li><code>-Werror={format, maybe-uninitialized, overflow, sign-compare}</code>: these warnings are treated as errors.</li>
<li><code>-f{data, function}-sections</code>: puts data and functions into their own linker section.</li>
<li><code>-funsigned-{char, bitfields}</code>: modm tries to use <code>stdint.h</code> types everywhere, but just in case.</li>
<li><code>-fwrapv</code>: integer overflows wrap around according to 2s complement.</li>
</ul>
<p>For <em>release builds</em>:</p>
<ul>
<li><code>-Os</code>: optimize for smaller size.</li>
</ul>
<p>For <em>debug builds</em>:</p>
<ul>
<li><code>-Og</code>: optimize for debugging experience.</li>
<li><code><a class="el" href="group__modm__architecture.html#ga5b2e65b7ec88d0fe255c8d776f4f42a9" title="Only defined in debug profile. ">MODM_DEBUG_BUILD</a></code>: this macro is only defined in debug profile. You can use it with <code>#ifdef <a class="el" href="group__modm__architecture.html#ga5b2e65b7ec88d0fe255c8d776f4f42a9" title="Only defined in debug profile. ">MODM_DEBUG_BUILD</a></code> to enable debug code.</li>
</ul>
<h4>Only C</h4>
<ul>
<li><code>-std=gnu2x</code>: use C23 with GNU extensions (for <code>asm volatile</code>).</li>
</ul>
<h4>Only C++</h4>
<ul>
<li><code>-std=c++23</code>: use C++23</li>
</ul>
<p>For exception and RTTI flags, see <a href="group__modm__stdc++.html"><code>modm:stdc++</code></a> module.</p>
<h4>Linker</h4>
<ul>
<li><code>--gc-section</code>: garbage collecting sections throws out a lot of unused data/code.</li>
<li><code>-L{linkdir} -Tlinkerscript.ld</code>: modm uses a custom linkerscript.</li>
</ul>
<p>For target specific flags, see the <a href="group__modm__platform__core.html"><code>modm:platform:core</code></a> and related modules.</p>
<h2>Configuration</h2>
<p>This module generates a common set of configuration files that are used by the common tooling. Please note that these files are the <em>foundation</em> of more extensive tooling available as Python scripts which are then again wrapped by your chosen build system for convenience.</p>
<h3>OpenOCD</h3>
<p>For accessing your ARM Cortex-M based device, we use OpenOCD by default and generate a <code>modm/openocd.cfg</code> file with the target specific configuration:</p>
<ul>
<li>Search directories passed via the <code>path.openocd</code> collector.</li>
<li>User configuration files passed via the <code>openocd.source</code> collector. Your custom <a href="group__modm__build.html"><code>modm:build:openocd.cfg</code></a> is added here too.</li>
</ul>
<p>You need to start openocd with this configuration file:</p>
<div class="fragment"><div class="line">openocd -f modm/openocd.cfg</div>
</div><!-- end fragment -->
<dl class="section warning"><dt>Warning</dt><dd>Be careful attaching to a running target The OpenOCD implementation halts the target at least while the device's debug peripheral is initialized. Only connect to systems that cannot create any damage while being halted! For example halting motor controllers may damage motors!!</dd></dl>
<h3>AvrDude</h3>
<p>Unfortunately AvrDude does not support a <em>project-specific</em> configuration file like OpenOCD does (only a undocumented user config in <code>~/.avrduderc</code>), so there is no convenient one-line command to issue. You have to use the wrapper support of the specific build system or simply call AvrDude yourself via its command line.</p>
<h3>GDB</h3>
<p>A few commands are provided for convenience via the <code>modm/gdbinit</code> configuration:</p>
<ul>
<li><code>reset</code>: resets the device and halts.</li>
<li><code>rerun</code>: resets the device and continues execution.</li>
<li><code>modm_coredump</code>: Dumps all volatile memories into a <code>coredump.txt</code> file. See the <code>modm:platform:fault</code> module for details.</li>
<li><code>modm_build_id</code>: Finds and prints the GNU build id of the firmware.</li>
</ul>
<p>GDB continues running the target after attaching, but <em>does not</em> load an ELF file! Please pass the ELF file as a command line argument.</p>
<p>You can start your GDB session like so:</p>
<div class="fragment"><div class="line">arm-none-eabi-gdb -x modm/gdbinit path/to/project.elf</div>
</div><!-- end fragment -->
<h2>Generic Python Tools</h2>
<p>We have written a number of pure Python tools to provide common functionality that get wrapped by the build system.</p>
<p>Here is a selection of tools that have a command line interface, so you can call them even without build system support in case you have a special setup. Note that there are even more tools that can be called in Python only, so have a look in your generated <code>modm/modm_tools</code> folder.</p>
<dl class="section note"><dt>Note</dt><dd>Add <code>modm_tools</code> to your Python path To call <code>modm_tools</code> via module syntax, you need to add the generated modm folder to your Python path: <code>export PYTHONPATH=path/to/generated/modm</code>. You can also use the module in this repository directly.</dd></dl>
<h3>AvrDude</h3>
<p>This tool simply wraps the <code>avrdude</code> command to provide two features:</p>
<ul>
<li>guessing the serial port when a baudrate was set.</li>
<li>inspecting the ELF file to decide whether EEPROM needs to be programmed.</li>
</ul>
<div class="fragment"><div class="line">python3 -m modm_tools.avrdude -p m328p -c arduino -P auto -b 57600 \\</div>
<div class="line">                              path/to/project.elf</div>
</div><!-- end fragment -->
<p><a href="http://avr-libc.nongnu.org/user-manual/group__avr__fuse.html">Fuses stored in the ELF file</a> can be programmed by passing <code>--fuse</code> arguments:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.avrdude -p m328p -c stk500v2 path/to/project.elf \\</div>
<div class="line">                              --fuse hfuse --fuse lfuse --fuse efuse</div>
</div><!-- end fragment -->
<p>(* <em>only AVR targets</em>)</p>
<h3>OpenOCD</h3>
<p>Simply wraps OpenOCD and issues the right command to program the target.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.openocd -f modm/openocd.cfg path/to/project.elf</div>
</div><!-- end fragment -->
<p>You can also reset the target:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.openocd -f modm/openocd.cfg --reset</div>
</div><!-- end fragment -->
<p>You can use a different OpenOCD binary by setting the <code>MODM_OPENOCD_BINARY</code> environment variable before calling this script. This can be useful when using a custom OpenOCD build for specific targets.</p>
<div class="fragment"><div class="line">export MODM_OPENOCD_BINARY=/path/to/other/openocd</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>Black Magic Probe</h3>
<p>This tool wraps GDB to program an ELF file onto a target connected to a BMP. You can explictly pass the serial port, or let the tool guess it.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.bmp path/to/project.elf</div>
<div class="line"># or choose the port explicitly</div>
<div class="line">python3 -m modm_tools.bmp path/to/project.elf -p /dev/tty.usbserial-123</div>
</div><!-- end fragment -->
<p>You can also reset the target:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.bmp --reset</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>GDB</h3>
<p>For debugging your program on ARM Cortex-M device, this Python tool wraps <code>arm-none-eabi-gdb</code> and connects it to a number of programmers running in the background or remotely.</p>
<p>The tool can be called from the command line. Here is a typical use-case using the openocd backend with the common configuration files:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.gdb --elf path/to/project.elf --ui=tui \</div>
<div class="line">                          -x modm/gdbinit -x modm/openocd_gdbinit \</div>
<div class="line">                          openocd -f modm/openocd.cfg</div>
</div><!-- end fragment -->
<p>Or you can call the Python API directly:</p>
<div class="fragment"><div class="line">import sys</div>
<div class="line">sys.path.append(&quot;modm&quot;)</div>
<div class="line">from modm_tools import gdb</div>
<div class="line">from modm_tools.openocd import OpenOcdBackend</div>
<div class="line"> </div>
<div class="line">backend = OpenOcdBackend(config=&quot;modm/openocd.cfg&quot;)</div>
<div class="line">gdb.call(source=&quot;path/to/project.elf&quot;, backend=backend,</div>
<div class="line">         config=[&quot;modm/gdbinit&quot;, &quot;modm/openocd_gdbinit&quot;], ui=&quot;tui&quot;)</div>
</div><!-- end fragment -->
<p>This configuration starts the OpenOCD process in the background for you, however, if you want to connect to an already running process, you can use the remote backend with the <code>--host={ip or hostname}</code> via the command line:</p>
<div class="fragment"><div class="line"># Extended-Remote running remotely</div>
<div class="line">python3 -m modm_tools.gdb --elf path/to/project.elf -x modm/gdbinit --ui=tui \</div>
<div class="line">                          remote --host 123.45.67.89</div>
</div><!-- end fragment -->
<p>Note that you can use different programmer backends to GDB, for example the Black Magic Probe:</p>
<div class="fragment"><div class="line"># Black Magic Probe</div>
<div class="line">python3 -m modm_tools.gdb --elf path/to/project.elf -x modm/gdbinit --ui=tui \</div>
<div class="line">                          bmp --port /dev/tty.usbserial-123</div>
</div><!-- end fragment -->
<p>To analyze a core dump, you can use the <code>CrashDebug</code> GDB backend. See the <code>modm:crashcatcher</code> module for details.</p>
<div class="fragment"><div class="line"># Using CrashDebug for Post-Mortem debugging</div>
<div class="line">python3 -m modm_tools.gdb --elf path/to/project.elf -x modm/gdbinit --ui=tui \</div>
<div class="line">                          crashdebug --dump coredump.txt</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<p>Currently three UIs are implemented for debugging:</p>
<ul>
<li><code>--ui=cmd</code>: No UI, only the GDB command shell.</li>
<li><code>--ui=tui</code>: Text-based UI in your shell.</li>
<li><code>--ui=gdbgui</code>: Web-based UI in your browser, based on <a href="https://www.gdbgui.com">gdbgui</a>.</li>
</ul>
<h4>Text UI</h4>
<p>This UI is builtin to GDB and is therefore always available.</p>
<div class="fragment"><div class="line">   ┌——main.cpp———————————————————————————————————————————————————————┐</div>
<div class="line">  &gt;│194             DRAW(x+1, y+3);                                  │</div>
<div class="line">   │195             DRAW(x+2, y+3);                                  │</div>
<div class="line">   │196     #<span class="keywordflow">else</span>                                                    │</div>
<div class="line">   │197             DRAW(x  , y  );                                  │</div>
<div class="line">   │198     #endif                                                   │</div>
<div class="line">   │199     #undef DRAW                                              │</div>
<div class="line">   │200     }                                                        │</div>
<div class="line">   │201                                                              │</div>
<div class="line">   │202     <span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> drawScreen(framebuffer_t before, frame│</div>
<div class="line">   └—————————————————————————————————————————————————————————————————┘</div>
<div class="line">  &gt;│0x80017a0 &lt;game_of_life()+1692&gt; strh.w r3, [r4, r12, lsl #1]     │</div>
<div class="line">   │0x80017a4 &lt;game_of_life()+1696&gt; add    r0, lr                    │</div>
<div class="line">   │0x80017a6 &lt;game_of_life()+1698&gt; ldr    r2, [r2, #0]              │</div>
<div class="line">   │0x80017a8 &lt;game_of_life()+1700&gt; strh.w r3, [r2, r0, lsl #1]      │</div>
<div class="line">   │0x80017ac &lt;game_of_life()+1704&gt; ldr    r3, [sp, #12]             │</div>
<div class="line">   │0x80017ae &lt;game_of_life()+1706&gt; ldr    r2, [sp, #0]              │</div>
<div class="line">   │0x80017b0 &lt;game_of_life()+1708&gt; add    r2, r3                    │</div>
<div class="line">   │0x80017b2 &lt;game_of_life()+1710&gt; ldrb   r3, [r7, r1]              │</div>
<div class="line">   │0x80017b4 &lt;game_of_life()+1712&gt; strb   r3, [r2, r1]              │</div>
<div class="line">   └—————————————————————————————————————————————————————————————————┘</div>
<div class="line">extended-r Remote target In: game_of_life         L194  PC: 0x80017a0</div>
<div class="line"> </div>
<div class="line">Program received signal SIGINT, Interrupt.</div>
<div class="line">0x080017a0 in drawPixel (color=&lt;optimized out&gt;, y=42, x=578) at main.c</div>
<div class="line">(gdb)</div>
</div><!-- end fragment -->
<h4>Web UI</h4>
<p>This UI simply uses the <a href="https://www.gdbgui.com">gdbgui</a> project and works very well as an advanced IDE-independent debugging solution.</p>
<p><img src="https://github.com/cs01/gdbgui/raw/master/screenshots/gdbgui_animation.gif" alt="" class="inline"/></p>
<h3>Size Report</h3>
<p>Inspects the ELF file and generates a size report of the static usage of the device's memories. You must pass the available memory segments as a Python dictionary:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.size path/to/project.elf \\</div>
<div class="line">    &quot;[{&#39;name&#39;: &#39;flash&#39;, &#39;access&#39;: &#39;rx&#39;, &#39;start&#39;: 134217728, &#39;size&#39;: 65536}, \\</div>
<div class="line">    {&#39;name&#39;: &#39;sram1&#39;, &#39;access&#39;: &#39;rwx&#39;, &#39;start&#39;: 536870912, &#39;size&#39;: 20480}]&quot;</div>
<div class="line"> </div>
<div class="line">Program:   1.4 KiB /  64.0 KiB (2.2% used)</div>
<div class="line">(.build_id + .fastcode + .fastdata + .hardware_init + .rodata +</div>
<div class="line"> .table.copy.intern + .table.heap + .table.zero.intern + .text + .vector_rom)</div>
<div class="line"> </div>
<div class="line">Data:      3.0 KiB /  20.0 KiB (15.1% used) = 20 B static (0.1%) + 3072 B stack (15.0%)</div>
<div class="line">(.bss + .fastdata + .stack)</div>
<div class="line"> </div>
<div class="line">Heap:     17.0 KiB /  20.0 KiB (84.9% available)</div>
<div class="line">(.heap1)</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>Information Tool</h3>
<p>This tool generates a set of source files containing information about the repository state.</p>
<p>You can use the <code>--check-rebuild</code> flag to only write the output file when the information changed. This prevents unnecessary rebuilding and relinking.</p>
<dl class="section warning"><dt>Warning</dt><dd>Respect developers privacy This information is placed into the firmware in <b>cleartext</b>, so it will be trivial to extract from a memory dump. Consider this information public as soon as it is uploaded to your target. Make sure you only use the information you absolutely need!</dd></dl>
<h4>Git Information</h4>
<div class="fragment"><div class="line">python3 -m modm_tools.info -o git_info.c -t git        [--check-rebuild]</div>
<div class="line">python3 -m modm_tools.info -o git_info.c -t git_status [--check-rebuild]</div>
</div><!-- end fragment -->
<p>The <code>git_info(directory)</code> function returns a dictionary with these values:</p>
<ul>
<li><code>MODM_GIT_SHA</code>: commit hash: <code>H</code>.</li>
<li><code>MODM_GIT_SHA_ABBR</code>: short commit hash: <code>h</code>.</li>
<li><code>MODM_GIT_SUBJECT</code>: commit subject as text: <code>s</code>.</li>
<li><code>MODM_GIT_AUTHOR</code>: author name: <code>an</code>.</li>
<li><code>MODM_GIT_AUTHOR_EMAIL</code>: author email: <code>ae</code>.</li>
<li><code>MODM_GIT_AUTHOR_DATE</code>: authoring date: <code>ad</code>.</li>
<li><code>MODM_GIT_AUTHOR_DATE_TIMESTAMP</code>: authoring date as Unix timestamp: <code>at</code>.</li>
<li><code>MODM_GIT_COMMITTER</code>: committer name: <code>cn</code>.</li>
<li><code>MODM_GIT_COMMITTER_EMAIL</code>: committer email: <code>ce</code>.</li>
<li><code>MODM_GIT_COMMITTER_DATE</code>: committer date: <code>cd</code>.</li>
<li><code>MODM_GIT_COMMITTER_DATE_TIMESTAMP</code>: committer das as Unix timestamp: <code>ct</code>.</li>
<li><code>MODM_GIT_CONFIG_USER_NAME</code>: local user name: <code>user.name</code>.</li>
<li><code>MODM_GIT_CONFIG_USER_EMAIL</code>: local user email: <code>user.email</code>.</li>
</ul>
<p>The <code>git_info(directory, with_status=True)</code> function returns these additional values:</p>
<ul>
<li><code>MODM_GIT_MODIFIED</code>: number of modified files: <code>M</code>.</li>
<li><code>MODM_GIT_ADDED</code>: number of added files: <code>A</code>.</li>
<li><code>MODM_GIT_DELETED</code>: number of deleted files: <code>D</code>.</li>
<li><code>MODM_GIT_RENAMED</code>: number of renamed files: <code>R</code>.</li>
<li><code>MODM_GIT_COPIED</code>: number of copied files: <code>C</code>.</li>
<li><code>MODM_GIT_UNTRACKED</code>: number of untracked files: <code>?</code>.</li>
</ul>
<p>This example project is showing an unclean repository state with uncommitted changes. This can give you a few hints as to where a firmware came from and help you pinpoint the source of a bug or feature.</p>
<div class="fragment"><div class="line">Local Git User:</div>
<div class="line">Name:  Name Surname</div>
<div class="line">Email: name.surname@example.com</div>
<div class="line">Last Commit:</div>
<div class="line">SHA:             1b5a9a642857182161a615039c92907e59881614</div>
<div class="line">Abbreviated SHA: 1b5a9a642</div>
<div class="line">Subject:         wip</div>
<div class="line"> </div>
<div class="line">Author:</div>
<div class="line">Name:      Name Surname</div>
<div class="line">Email:     name.surname@example.com</div>
<div class="line">Date:      Tue Jul 17 22:23:20 2018 +0200</div>
<div class="line">Timestamp: 1531859000</div>
<div class="line"> </div>
<div class="line">Committer:</div>
<div class="line">Name:      Name Surname</div>
<div class="line">Email:     name.surname@example.com</div>
<div class="line">Date:      Tue Jul 17 22:23:20 2018 +0200</div>
<div class="line">Timestamp: 1531859000</div>
<div class="line"> </div>
<div class="line">File Status:</div>
<div class="line">Modified:  10</div>
<div class="line">Added:     0</div>
<div class="line">Deleted:   0</div>
<div class="line">Renamed:   0</div>
<div class="line">Copied:    0</div>
<div class="line">Untracked: 6</div>
</div><!-- end fragment -->
<h4>Build Information</h4>
<div class="fragment"><div class="line">python3 -m modm_tools.info -o build_info.c -t build --compiler=gcc [--check-rebuild]</div>
</div><!-- end fragment -->
<p>Generates a files with these values defined as <code>const char *</code> strings:</p>
<ul>
<li><code>MODM_BUILD_PROJECT_NAME</code>: as defined in the <a href="group__modm__build.html"><code>modm:build:project.name</code></a> option.</li>
<li><code>MODM_BUILD_MACHINE</code>: machine information.</li>
<li><code>MODM_BUILD_USER</code>: user information.</li>
<li><code>MODM_BUILD_OS</code>: OS version string (best effort, may not be useful!).</li>
<li><code>MODM_BUILD_COMPILER</code>: compiler information.</li>
</ul>
<p>Example output on macOS:</p>
<div class="fragment"><div class="line">Project:  build_info</div>
<div class="line">Machine:  name.local</div>
<div class="line">User:     user</div>
<div class="line">OS:       macOS 10.14.6 (x86_64)</div>
<div class="line">Compiler: g++-10 10.2.0</div>
</div><!-- end fragment -->
<h3>JLink</h3>
<p>Simply wraps JLinkGDBServer and issues the right command to program the target.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.jlink -device STM32F469NI path/to/project.elf</div>
</div><!-- end fragment -->
<p>You can also reset the target:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.jlink -device STM32F469NI --reset</div>
</div><!-- end fragment -->
<p>You can set the <code>MODM_JLINK_BINARY</code> environment variable to point this script to a specific <code>JLinkGDBServer</code> binary:</p>
<div class="fragment"><div class="line">export MODM_JLINK_BINARY=/path/to/other/JLinkGDBServer</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>Unittest</h3>
<p>This tools scans a directory for files ending in <code>_test.hpp</code>, extracts their test cases and generates a source file containing the test runner.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.unit_test path/containing/tests path/to/generated_runner.cpp</div>
</div><!-- end fragment -->
<p>Note that the files containing unittests must contain <em>one</em> class that inherits from the <code>unittest::TestSuite</code> class, and test case names must begin with <code>test</code>:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>TestClass : <span class="keyword">public</span> unittest::TestSuite</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> testCase1();</div>
<div class="line">}</div>
</div><!-- end fragment -->
<h3>Logging via Single-Wire Output (SWO)</h3>
<p>Logging using the SWO protocol is supported by the <code>modm:platform:itm</code> module. You can use OpenOCD to receive the output, but you must manually supply the CPU frequency:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.itm openocd -f modm/openocd.cfg --fcpu 48000000</div>
</div><!-- end fragment -->
<p>JLink is also supported and can determine the CPU frequency automatically:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.itm jlink -device STM32F469NI</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>Logging via Real-Time Transport (RTT)</h3>
<p>Logging using the RTT protocol is supported by the <a href="group__modm__platform__rtt.html"><code>modm:platform:rtt</code></a> module. You can use OpenOCD to send and receive on a channel of your choice using the built-in Python telnet client:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.rtt --channel 0 openocd -f modm/openocd.cfg</div>
</div><!-- end fragment -->
<p>JLink is also supported and may have faster transfer rates:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.rtt --channel 0 jlink -device STM32F469NI</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>GNU Build-ID</h3>
<p>To extract the build ID from an ELF file:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.build_id path/to/project.elf</div>
<div class="line">fa8918e6971ed783b25bff0ad11a0541be47a933</div>
</div><!-- end fragment -->
<p>To copy the ELF file to a artifact cache:</p>
<div class="fragment"><div class="line">python3 -m modm_tools.build_id path/to/project.elf --cache path/to/folder</div>
<div class="line"># copies to `path/to/folder/fa8918e6971ed783b25bff0ad11a0541be47a933.elf`</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h3>Bitmap</h3>
<p>This tool can convert P1 <code>.pbm</code> files into C++ source code.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.bitmap image.pbm --outpath .</div>
<div class="line"># creates `image.hpp` and `image.cpp` in the CWD</div>
</div><!-- end fragment -->
<h3>UF2 Converter</h3>
<p>UF2 is a <a href="https://github.com/microsoft/uf2">Microsoft file format</a> to pass to a on-device bootloader.</p>
<div class="fragment"><div class="line">python3 -m modm_tools.elf2uf2 firmware.elf -o firmware.uf2 --target rp2040 \</div>
<div class="line">    --range 0x10000000:0x15000000:CONTENTS \</div>
<div class="line">    --range 0x20000000:0x20042000:NO_CONTENTS</div>
</div><!-- end fragment -->
<p>(* <em>only ARM Cortex-M targets</em>)</p>
<h2>Module Options</h2>
<h3>modm:build:project.name: Project Name</h3>
<p>The project name defaults to the folder name you're calling lbuild from.</p>
<p>It's used by your build system to name the executable and it may also be passed to your application via a string constant or CPP define.</p>
<p>Generated with: <code>hypocaustum-valve-ctrl in [String: valve-ctrl]</code> </p><h3>modm:build:build.path: Build Path</h3>
<p>The build path is defaulted to <code>build/{modm:build:project.name}</code>.</p>
<p>If you have a lot of embedded projects, you may want to change the build path to a <em>common</em> directory so that you don't have <code>build/</code> folders everywhere. Remember to add your build path to your <code>.gitignore</code>.</p>
<p>You should use a relative path instead of an absolute one, so that this option still works for other developers.</p>
<p>Generated with: <code>build\valve-ctrl in [Path]</code> </p><h3>modm:build:unittest.source: Path to directory containing unittests</h3>
<p>When this path is declared, the generated build script will compile <b>only</b> the unittests, not your application source code! You must use separate project configurations for compiling your unittest and application!</p>
<p>Generated with: <code>[] in [Path]</code> </p><h3>modm:build:image.source: Path to directory containing .pbm files</h3>
<p>Generated with: <code>[] in [Path]</code> </p><h3>modm:build:info.git: Generate git repository state information</h3>
<ul>
<li><code>Info</code>: generates information about the last commit.</li>
<li><code>Info+Status</code>: like <code>Info</code> plus git file status.</li>
</ul>
<p>Generated with: <code>Info+Status in [Disabled, Info, Info+Status]</code> </p><h3>modm:build:info.build: Generate build state information</h3>
<p>Generated with: <code>true in [yes, no]</code> </p><h3>modm:build:openocd.cfg: Path to a custom OpenOCD configuration file</h3>
<p>If you have a custom configuration file for your target, it will get included by the generated <code>modm/openocd.cfg</code>.</p>
<p>This is useful for not having to duplicate your config if you have several projects using the same target (like small bring-up and test projects).</p>
<dl class="section note"><dt>Note</dt><dd>Do not execute commands by default When providing your own config file, wrap your specific commands into functions and do not execute them by default. A stray <code>init</code> or similar in your script will mess with modm's ability to program and debug a device correctly.</dd></dl>
<p>Generated with: <code>[] in [Path]</code> </p>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for DoxyPress 1.3.7-->
<!-- Generated by DoxyPress 1.7.0 -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.copperspice.com/documentation-doxypress.html">
    <img class="footer" src="doxypress.png" alt="DoxyPress"/></a> 1.7.0 </li>
  </ul>
</div>
<script>
if (window.location.href.includes("modm.io")) {
 var device = /\/api\/([a-zA-Z0-9_-]+)\//.exec(window.location.href)[1].toUpperCase();
 document.title = document.title.replace("modm API documentation", "modm API documentation for " + device);
 document.getElementById('projectname').innerHTML = document.getElementById('projectname').innerHTML.replace("modm API documentation", "modm API documentation for " + device);
}
document.getElementById('MSearchResults').onload = function()
{
  var iframe = document.getElementById('MSearchResults').contentWindow.document;
  var head = iframe.getElementsByTagName("head")[0];
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom.css");
  head.appendChild(link);
  var link = iframe.createElement("link");
  link.setAttribute("rel", "stylesheet");
  link.setAttribute("type", "text/css");
  link.setAttribute("href", "../custom_dark_theme.css");
  head.appendChild(link);
}
</script>
</body>
</html>
